function DashboardLayout(){var a=($(window).width()*1.5)/$("li.kanban").length;a=(a<400?400:a);$("li.kanban").width(a);$("#dashboard").width(($("li.kanban").width()*$("li.kanban").length)+50)}function HTMLUnit(b,a,d){var c=removeAcentos(b.name.toLowerCase());return(a!==false?'<li data-search="'+c+'" class="unity" data-id="'+b.id+'">':"")+'<input type="checkbox" id="check-'+c+b.id+'"> <label for="check-'+c+b.id+'"></label><i class="material-icons left show-subunit">arrow_drop_down</i><div><span class="title"> <b>'+b.name+"</b>"+(b.type==1?" - Head Office":"")+'</span><ul class="actions"><a href="/'+b.company_id+"/unity/"+b.id+'" class="open-modal" data-footer-fixed="true"> <li><i class="material-icons">build</i></li> </a><a href="/'+b.company_id+"/unity/new/"+b.id+'" class="open-modal" data-footer-fixed="true"> <li><i class="material-icons tooltipped">add</i></li> </a></ul></div><ul class="subunits">'+(d?LoadUnits(d,b.id):"")+"</ul>"+(a!==false?"</li>":"")}function HTMLUser(a,b){return(b!==false?'<tr data-search="'+removeAcentos(a.name.toLowerCase())+'" data-id="'+a.id+'">':"")+'<td><img src="https://tbl-manager-3j39v2313323iump.s3.amazonaws.com/users/thumb-21774_10200415689552293_62507479943561673_n.jpg"><span><b>'+a.name+" "+a.lastname+"</b>"+(a.position!=""?" - "+a.position:"")+'<ul><a class="open-modal" data-footer-fixed="true" href="'+a.company_id+"/user/"+a.id+'"> <li><i class="material-icons">build</i></li> </a></ul></span></td>'+(b!==false?"</tr>":"")}function LoadUnits(a,b){var c="";b=b?b:0;if(!a[b]){return""}$.each(a[b],function(e,d){c+=HTMLUnit(d,true,a)});return c}$(document).ready(function(){DashboardLayout();var a=Companies;a.Key="company";a.Hidden=["id","company_id"];a.Fields["name"]["label"]="Nome";a.Fields["logo"]["type"]="image";a.Fields["logo"]["location"]="/logos";Grid(a,"#grid-company");$("li.kanban#list-company tbody tr").off();$(document).on("click","li.kanban#list-company tbody tr",function(){if($("#grid-tbl_companies tr.active").data("id")==$(this).data("id")){return false}$("#list-units, #list-users").removeClass("block");$("#list-indicators, #list-assignment").addClass("block");$("#list-units ul li a:eq(1)").attr("href",$(this).data("id")+"/unity/new");$("#list-users ul li a:eq(1)").attr("href",$(this).data("id")+"/user/new");$("#grid-tbl_companies tr.active").removeClass("active");$(this).addClass("active");$("#list-units ul.units").html(LoadUnits(Units.Values[$(this).data("id")],false));Load({Type:"POST",DataType:"json",Url:"/"+$(this).data("id")+"/users",navAjax:false,Success:function(b){$("#table-users tbody").html("");$.each(b.Values,function(d,c){$("#table-users tbody").prepend(HTMLUser(c))})}})});$(".show-subunit").off();$(document).on("click",".show-subunit",function(){$(this).toggleClass("drop");$(this).parent("li").find(".subunits:eq(0)").toggle()});$(document).on("click",'#list-units ul input[type="checkbox"]',function(){$(this).parent().toggleClass("active");if($('#list-units ul input[type="checkbox"]:checked').length>0){$("#list-indicators").removeClass("block")}else{$("#list-indicators").addClass("block")}});$(document).on("click",'#table-indicadores tr input[type="checkbox"]',function(){$(this).parent().toggleClass("active");if($('#table-indicadores tr input[type="checkbox"]:checked').length>0){$("#list-assignment").removeClass("block")}else{$("#list-assignment").addClass("block")}})});$(window).resize(function(){DashboardLayout()});